(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{3020:(e,t,a)=>{"use strict";async function r(e,t,a,r){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"POST",s=async a=>fetch(e,{method:n,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(t)}),l=await s(a);if((401===l.status||403===l.status)&&r)try{let e=await r();e&&(l=await s(e))}catch(e){}if(!l.ok){let t=Error("HTTP ".concat(l.status));t.status=l.status,t.url=e;try{t.body=await l.text()}catch(e){}throw t}return l}async function n(e,t,a){let n=await r("https://6ts7sjoaw6.execute-api.ap-southeast-2.amazonaws.com/test/getIMEI",{email:e},t,a),s=await n.json(),l={};try{var i;l=JSON.parse(null!=(i=null==s?void 0:s.body)?i:"{}")}catch(e){console.error("getIMEIList JSON parse error",e)}let o=Array.isArray(null==l?void 0:l.items)?l.items:[],c=Array.isArray(null==l?void 0:l.dev_access)?l.dev_access:[];return{items:o.filter(e=>Array.isArray(e.Coordinate)&&2===e.Coordinate.length),dev_access:c.map(e=>Array.isArray(e)?e.map(String):[])}}async function s(e,t,a){var n;let s=await r("https://6ts7sjoaw6.execute-api.ap-southeast-2.amazonaws.com/test/getLatestDP",{IMEI:e},t,a),l=JSON.parse(null!=(n=(await s.json()).body)?n:"[]"),i={},o={},c=0;for(let e of l)o[c]=e.DeviceType,i[e.DeviceType]=e,c++;return{deviceMap:i,deviceTypes:o}}async function l(e,t,a,n,s,l){var i;let o=await r("https://6ts7sjoaw6.execute-api.ap-southeast-2.amazonaws.com/test/getDpFromTime",{IMEI:e,startDateTime:t,endDateTime:a,timeInterval:s},n,l),c=JSON.parse(null!=(i=(await o.json()).body)?i:"{}");return{deviceTypes:c.deviceTypes||[],items:c.items||[]}}function i(e){let{IMEI:t,idToken:a,getIdToken:r,intervalMs:n=3e5,callback:l}=e,i=null,o=a;async function c(){try{let e;try{e=await s(t,o)}catch(a){if(((null==a?void 0:a.status)===401||(null==a?void 0:a.status)===403)&&r)try{let n=await r();if(n)o=n,e=await s(t,o);else throw a}catch(e){throw null!=e?e:a}else throw a}l(e)}catch(e){console.error("Poller tick failed:",e)}}return{async start(){await c(),i&&window.clearInterval(i),i=window.setInterval(c,n)},stop(){i&&(window.clearInterval(i),i=null)}}}a.d(t,{A5:()=>s,I:()=>l,W4:()=>i,bC:()=>n})},4555:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(5155),n=a(2115),s=a(4689),l=a(8379),i=a(1607),o=a(877),c=a(5310),d=a(3020);a(1124);var u=a(1606),m=a(1265),h=a(6117),p=a.n(h);let{RangePicker:v}=u.A,g=e=>{console.log("onOk: ",e)},y=function(e){let{setStartDateTime:t,setEndDateTime:a}=e;return(0,r.jsx)(m.A,{direction:"vertical",size:12,children:(0,r.jsx)(v,{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",onChange:(e,r)=>{console.log("Selected Time: ",e),console.log("Formatted Selected Time: ",r);let n=null==e?void 0:e.map(e=>p()(e).format("YYYY-MM-DD HH:mm:ss"));t(n[0].replace(" ","T")+".000Z"),a(n[1].replace(" ","T")+".000Z")},onOk:g})})};function f(e){let{IMEI:t,setValues:a,setcurrdev:n,setdevarr:s}=e,i=Array.isArray(t)?t:[];return(0,r.jsx)(l.A.Select,{multiple:!0,className:"brand-select","aria-label":"Select IMEIs",onChange:e=>{a(Array.from(e.target.selectedOptions).map(e=>e.value)),n([]),s([])},children:i.map((e,t)=>{var a,n,s;let l="string"==typeof e?e:null!=(n=null==e?void 0:e.Location)?n:String(null!=(a=null==e?void 0:e.DeviceID)?a:""),i="string"==typeof e?e:String(null!=(s=null==e?void 0:e.DeviceID)?s:"");return(0,r.jsxs)("option",{value:i,children:[l," (",i,")"]},t)})})}function x(e){let{devicearr:t,setcurrdev:a,allowed:n}=e;if(!t)return(0,r.jsx)("p",{children:"click refresh"});let s=new Set(n||[]),i=(Array.isArray(t)?t.map((e,t)=>[String(t),e]):Object.entries(t)).filter(e=>{let[t,a]=e;return 0===s.size||s.has(String(a))});return(0,r.jsx)(l.A.Select,{multiple:!0,className:"brand-select","aria-label":"Select devices",onChange:e=>{a(Array.from(e.target.selectedOptions).map(e=>e.value).map(e=>(Array.isArray(t),t[e])))},children:i.map(e=>{let[t,a]=e;return(0,r.jsx)("option",{value:t,children:a},t)})})}function j(e){let{setValue:t}=e;return(0,r.jsxs)(l.A.Select,{className:"brand-select","aria-label":"Default select example",onChange:e=>{e.target.value&&t(e.target.value)},children:[(0,r.jsx)("option",{children:"Choose Time Interval"}),(0,r.jsx)("option",{value:"1min",children:"1 min"}),(0,r.jsx)("option",{value:"5min",children:"5 min"}),(0,r.jsx)("option",{value:"15min",children:"15 min"}),(0,r.jsx)("option",{value:"1hr",children:"1 hours"}),(0,r.jsx)("option",{value:"1day",children:"1 day"})]})}function b(e){let{timeSeriesData:t,device:a,dataType:n,setDataType:s}=e;if(!t||0===t.length||!a||0===a.length)return(0,r.jsx)("p",{children:"Select device(s) first"});let i=new Set(["DeviceID","DeviceType","Timestamp"]),o=Array.from(new Set(t.filter(e=>a.includes(e.DeviceType)).flatMap(e=>Object.keys(e).filter(t=>!i.has(t)&&"number"==typeof e[t]))));return 0===o.length?(0,r.jsx)("p",{children:"No numeric data available"}):(0,r.jsx)(l.A.Select,{multiple:!0,className:"brand-select","aria-label":"Select data types",value:n,onChange:e=>{s(Array.from(e.target.selectedOptions).map(e=>e.value))},children:o.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})}i.t1.register(i.PP,i.kc,i.FN,i.No,i.hE,i.m_,i.s$,i.UA,i.iw,i.Bs);let S=e=>{let{data:t,filename:a="export.csv"}=e;return(0,r.jsx)("button",{className:"brand-button",onClick:()=>{if(!t||0===t.length)return void alert("No data to export");let e=new Blob([(e=>{if(!e||0===e.length)return"";let t=["DeviceID","Timestamp","DeviceType"],a=new Set;for(let r of e)for(let e of Object.keys(r))t.includes(e)||a.add(e);let r=[...t,...Array.from(a)];return r.join(",")+"\n"+e.map(e=>r.map(t=>{var a;let r=null!=(a=e[t])?a:"";return"string"==typeof r&&(r='"'.concat(r.replace(/"/g,'""'),'"')),r}).join(",")).join("\n")})(t)],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.setAttribute("download",a),document.body.appendChild(n),n.click(),document.body.removeChild(n)},children:"Download CSV"})},w=function(){var e,t,a,l;let i=(0,s.As)(),[u,m]=(0,n.useState)({username:"",name:""}),[h,v]=(0,n.useState)([]),[g,w]=(0,n.useState)([]),[N,A]=(0,n.useState)(""),[D,I]=(0,n.useState)(""),[T,E]=(0,n.useState)([]),[k,C]=(0,n.useState)([]),[M,_]=(0,n.useState)(""),[L,O]=(0,n.useState)(""),[P,z]=(0,n.useState)([]),[H,R]=(0,n.useState)([]),[F,Y]=(0,n.useState)(""),[B,U]=(0,n.useState)({}),[V,W]=(0,n.useState)([]),J=(0,n.useRef)(null),[G,q]=(0,n.useState)({}),[Z,$]=(0,n.useState)("theme-b"),[K,Q]=(0,n.useState)("/logos/logo1.png"),[X,ee]=(0,n.useState)("mode-light"),[et,ea]=(0,n.useState)("latest"),er={responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Sensor Data Time Series"},legend:{display:!0}},scales:{x:{type:"timeseries",time:{unit:"minute"},title:{display:!0,text:"Timestamp"}},y:{type:"linear",title:{display:!0,text:Array.isArray(P)&&1===P.length?P[0]:"Value"}}}};(0,n.useEffect)(()=>{let e=localStorage.getItem("theme-name")||"theme-a";$(e);let t="theme-a"===e?1:"theme-b"===e?2:3;Q("/logos/logo".concat(t,".png"));let a=localStorage.getItem("mode-name")||"mode-light";ee(a);let r=document.body.classList;r.remove("theme-a","theme-b","theme-c","mode-light","mode-dark"),r.add(e),r.add(a)},[]),(0,n.useEffect)(()=>{var e;(async()=>{if(i.isAuthenticated){var e;let t=await fetch("https://ap-southeast-2d19wijvbp.auth.ap-southeast-2.amazoncognito.com/oauth2/userInfo",{method:"GET",headers:{Authorization:"Bearer ".concat(null==(e=i.user)?void 0:e.access_token)}});m(await t.json())}})(),(async e=>{if(i.isAuthenticated&&e)try{var t;let a=async()=>{var e;try{let e=null==i?void 0:i.signinSilent;if("function"==typeof e){let t=await e(),a=null==t?void 0:t.id_token;if(a)return a}}catch(e){}return null==(e=i.user)?void 0:e.id_token},r=await (0,d.bC)(e,null==(t=i.user)?void 0:t.id_token,a),n=Array.isArray(r.items)?r.items:[];v(n);let s=Array.isArray(r.dev_access)?r.dev_access:[],l={};if(n.forEach((e,t)=>{let a=Array.isArray(s[t])?s[t].map(String):[];l[String(e.DeviceID)]=a}),U(l),g&&g.length>0){let e=new Set;g.forEach(t=>(l[String(t)]||[]).forEach(t=>e.add(t))),W(Array.from(e))}}catch(e){console.error("getIMEIList error:",e)}})(null==(e=i.user)?void 0:e.profile.email)},[i.isAuthenticated,null==(e=i.user)?void 0:e.access_token,null==(t=i.user)?void 0:t.profile.email,null==(a=i.user)?void 0:a.id_token]),(0,n.useEffect)(()=>{if(!g||0===g.length)return void W([]);let e=new Set;g.forEach(t=>(B[String(t)]||[]).forEach(t=>e.add(t))),W(Array.from(e))},[g,B]);let en=(e,t)=>{q(a=>{let r={...a,[e]:t};return C(Array.from(new Set(Object.values(r).flat()))),r})};(0,n.useEffect)(()=>{q(e=>{let t={};return g.forEach(a=>{e[a]&&(t[a]=e[a])}),C(Array.from(new Set(Object.values(t).flat()))),t})},[g]);let es=async()=>{var e;if(g&&0!==g.length&&(null==(e=i.user)?void 0:e.id_token))try{let e=async()=>{try{let e=null==i?void 0:i.signinSilent;if("function"==typeof e){let t=await e(),a=null==t?void 0:t.id_token;if(a)return a}}catch(e){}return i.user.id_token},t=await Promise.all(g.map(t=>(0,d.A5)(t,i.user.id_token,e))),a={},r=new Set;t.forEach(e=>{(Array.isArray(e.deviceTypes)?e.deviceTypes:Object.values(e.deviceTypes||{})).forEach(e=>r.add(e)),Object.entries(e.deviceMap||{}).forEach(e=>{var t;let[r,n]=e,s=(null==n?void 0:n.Timestamp)||"",l=(null==(t=a[r])?void 0:t.Timestamp)||"";(!a[r]||s>l)&&(a[r]=n)})}),A(a),E(Array.from(r)),Y(p()().format("YYYY-MM-DD HH:mm:ss"))}catch(e){console.error("getLatestDP error:",e)}},el=async()=>{var e;if(g&&0!==g.length&&(null==(e=i.user)?void 0:e.id_token))try{let e=await Promise.all(g.map(e=>(0,d.I)(e,M,L,i.user.id_token,D))),t=new Set,a=[];e.forEach(e=>{(e.deviceTypes||[]).forEach(e=>t.add(e)),a.push(...e.items||[])}),E(Array.from(t)),R(a)}catch(e){console.error("getDPFromTime error:",e)}},ei=async()=>{var e;if(i.isAuthenticated&&g&&0!==g.length&&(null==(e=i.user)?void 0:e.id_token)){if(J.current){try{window.clearInterval(J.current)}catch(e){}J.current=null}await es(),J.current=window.setInterval(()=>{es()},3e5)}},eo=()=>{if(J.current){try{window.clearInterval(J.current)}catch(e){}J.current=null}};(0,n.useEffect)(()=>(eo(),()=>eo()),[g]);let ec=(()=>{if(!g||0===g.length||!k||0===k.length||!P||0===P.length||0===H.length)return{datasets:[]};let e=["#36a2eb","#ff6384","#4bc0c0","#9966ff","#ff9f40","#c9cbcf","#2ecc71","#c0392b"],t=[];return g.forEach((a,r)=>{k.forEach((n,s)=>{P.forEach((l,i)=>{let o=H.filter(e=>String(e.DeviceID)===String(a)&&e.DeviceType===n).filter(e=>"number"==typeof e[l]).map(e=>({x:e.Timestamp.split(".")[0].replace("T"," "),y:e[l]}));if(o.length>0){let c=e[(r*k.length*P.length+s*P.length+i)%e.length];t.push({label:"".concat(n," • ").concat(l," • IMEI ").concat(a),data:o,borderColor:c,backgroundColor:"transparent",tension:.1})}})})}),{datasets:t}})();return i.isLoading?(0,r.jsx)("div",{children:"Loading..."}):i.error?(0,r.jsxs)("div",{children:["Encountering error... ",i.error.message]}):i.isAuthenticated?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"top-nav brand-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,r.jsx)("img",{src:K,alt:"Company Logo",style:{height:"36px"},onError:e=>{e.currentTarget.src="/next.svg"}}),(0,r.jsx)("span",{className:"brand-title",children:"theme-a"===Z?"RHT Limited":"theme-b"===Z?"CMA testing":"Natsense"})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,r.jsxs)("select",{value:X,onChange:e=>{let t=e.target.value;ee(t),localStorage.setItem("mode-name",t);let a=document.body.classList;a.remove("mode-light","mode-dark"),a.add(t)},className:"brand-select",children:[(0,r.jsx)("option",{value:"mode-light",children:"Light"}),(0,r.jsx)("option",{value:"mode-dark",children:"Dark"})]}),(0,r.jsx)("button",{className:"brand-button button-outline",onClick:()=>(()=>{let e="".concat(window.location.origin,"/");try{var t;null==i||null==(t=i.removeUser)||t.call(i)}catch(e){}window.location.href="".concat("https://ap-southeast-2d19wijvbp.auth.ap-southeast-2.amazoncognito.com","/logout?client_id=").concat("7bj6qolgca3bbcshiuiinp9tj4","&logout_uri=").concat(encodeURIComponent(e))})(),children:"Sign out"}),(null==(l=i.user)?void 0:l.profile.email)==="natsense00@gmail.com"?(0,r.jsx)("button",{className:"brand-button button-outline",onClick:()=>window.location.replace("/admin"),children:"admin"}):(0,r.jsx)(r.Fragment,{})]})]}),(0,r.jsxs)("nav",{className:"side-nav",children:[(0,r.jsxs)("button",{className:"brand-button ".concat("latest"===et?"is-active":""),onClick:()=>ea("latest"),children:[" ",(0,r.jsx)("img",{src:"dashboard.png",alt:"Latest",style:{height:"36px"}}),"Latest Data"]}),(0,r.jsxs)("button",{className:"brand-button ".concat("history"===et?"is-active":""),onClick:()=>ea("history"),children:[(0,r.jsx)("img",{src:"chart.png",alt:"Latest",style:{height:"36px"}}),"History Data"]}),(0,r.jsxs)("a",{className:"brand-button",href:"/3d",children:[(0,r.jsx)("img",{src:"3d.png",alt:"Latest",style:{height:"36px"}}),"3D Mode"]}),(0,r.jsxs)("a",{className:"brand-button",href:"/controlPanel",children:[(0,r.jsx)("img",{src:"ControlPanel.png",alt:"Latest",style:{height:"36px"}}),"Control Panel"]})]}),(0,r.jsx)("div",{className:"content-shell",children:(0,r.jsxs)("div",{className:"page-container",children:[(0,r.jsxs)("div",{className:"panel",style:{marginTop:12},children:[(0,r.jsxs)("div",{className:"section-title",children:["Welcome, ",u.username||"User"]}),(0,r.jsx)("p",{style:{margin:0,opacity:.9},children:"Use the left menu to switch between Latest datapoint, History data, 3D mode, and Control Panel."})]}),(0,r.jsxs)("div",{style:{marginTop:12},children:["latest"===et&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"grid-2",style:{alignItems:"start"},children:[(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsx)("div",{className:"section-title",children:"Filters"}),(0,r.jsx)("p",{children:"IMEIs:"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(f,{IMEI:h,setValues:w,setcurrdev:C,setdevarr:E})}),g&&g.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"Devices per IMEI:"}),g.map(e=>{let t=B[String(e)]||[],a=(()=>{let t=h.find(t=>{var a;return String(null!=(a=null==t?void 0:t.DeviceID)?a:"")===String(e)});return(null==t?void 0:t.Location)?"".concat(t.Location," (").concat(String(e),")"):String(e)})();return(0,r.jsxs)("div",{className:"control-row",children:[(0,r.jsxs)("div",{style:{fontSize:12,opacity:.8,marginBottom:4},children:["IMEI: ",a]}),(0,r.jsx)(x,{devicearr:T,allowed:t,setcurrdev:t=>en(String(e),t)})]},e)})]}),(0,r.jsx)("p",{children:"Datatype:"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(b,{timeSeriesData:H,device:k,dataType:P,setDataType:z})}),(0,r.jsxs)("div",{className:"control-row",children:[(0,r.jsx)("button",{className:"brand-button",onClick:()=>{es(),ei()},style:{marginRight:8},children:"Get New Data"}),(0,r.jsx)("button",{className:"brand-button button-secondary",onClick:()=>eo(),children:"Stop Auto Refresh"})]})]}),(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsx)("div",{className:"section-title",children:"Latest Data Dashboard"}),(0,r.jsxs)("div",{style:{marginTop:4,marginBottom:8,opacity:.7,fontSize:12},children:["Last call: ",F||"-"]}),(0,r.jsx)(c.S,{deviceMap:N,device:k,dataType:P})]})]})}),"history"===et&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"grid-2",style:{alignItems:"start"},children:[(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsx)("div",{className:"section-title",children:"Filters"}),(0,r.jsx)("p",{children:"IMEIs:"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(f,{IMEI:h,setValues:w,setcurrdev:C,setdevarr:E})}),g&&g.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"Devices per IMEI:"}),g.map(e=>{let t=B[String(e)]||[],a=(()=>{let t=h.find(t=>{var a;return String(null!=(a=null==t?void 0:t.DeviceID)?a:"")===String(e)});return(null==t?void 0:t.Location)?"".concat(t.Location," (").concat(String(e),")"):String(e)})();return(0,r.jsxs)("div",{className:"control-row",children:[(0,r.jsxs)("div",{style:{fontSize:12,opacity:.8,marginBottom:4},children:["IMEI: ",a]}),(0,r.jsx)(x,{devicearr:T,allowed:t,setcurrdev:t=>en(String(e),t)})]},e)})]}),(0,r.jsx)("p",{children:"Datatype:"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(b,{timeSeriesData:H,device:k,dataType:P,setDataType:z})}),(0,r.jsx)("p",{children:"Average Interval:"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(j,{setValue:I})}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(y,{setStartDateTime:_,setEndDateTime:O})}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)("button",{className:"brand-button button-secondary",onClick:el,children:"Load Range"})})]}),(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsx)("div",{className:"section-title",children:"History Chart"}),ec.datasets.length>0&&(0,r.jsx)("div",{style:{height:500},children:(0,r.jsx)(o.N1,{data:ec,options:er})}),H.length>0&&0===ec.datasets.length&&(0,r.jsx)("div",{style:{marginTop:"20px",color:"orange"},children:(0,r.jsxs)("p",{children:["No data available for ",Array.isArray(k)?k.join(", "):k," - ",Array.isArray(P)?P.join(", "):P,". Please select a different data type."]})}),(0,r.jsxs)("div",{className:"panel",style:{marginTop:16},children:[(0,r.jsx)("div",{className:"section-title",children:"Export CSV"}),(0,r.jsx)("div",{className:"control-row",children:(0,r.jsx)(S,{data:H,filename:(g&&g.length?g.join("-"):"IMEI")+"_"+M.split(".")[0].replace("T"," ")+"_to_"+L.split(".")[0].replace("T"," ")+".csv"})})]})]})]})})]})]})})]}):(0,r.jsx)("div",{className:"page-container",style:{paddingTop:24},children:(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsx)("div",{className:"section-title",children:"Not signed in"}),(0,r.jsx)("p",{children:"Please go to the home page and click Sign in."}),(0,r.jsx)("a",{href:"/",className:"brand-button",children:"Go to Home"})]})})}},4749:(e,t,a)=>{Promise.resolve().then(a.bind(a,4555))},5310:(e,t,a)=>{"use strict";a.d(t,{S:()=>o});var r=a(5155),n=a(2115),s=a(877),l=a(1607);function i(e){let{title:t,value:a,max:l=100,unit:i="",color:o="#26b6b2",compact:c=!1}=e,d=Math.max(0,Math.min(Number(a),Number(l))),u=Math.max(0,Number(l)-d),m=c?16:20,h=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=()=>{var e,t,a;let r=null==(t=h.current)||null==(e=t.querySelector("canvas"))?void 0:e.parentElement;null==r||null==(a=r.forceUpdate)||a.call(r)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[c]),(0,r.jsxs)("div",{className:"panel",style:{padding:c?10:12},children:[(0,r.jsx)("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",fontSize:c?18:22},children:t}),(0,r.jsxs)("div",{ref:h,style:{height:c?120:150,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,r.jsx)(s.nu,{data:{labels:["Value","Remaining"],datasets:[{label:t,data:[d,u],backgroundColor:[o,"#d7d9dd"],hoverOffset:4,borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,rotation:-125,circumference:80*Math.PI,cutout:"60%",plugins:{legend:{display:!1},tooltip:{enabled:!1},title:{display:!1}},layout:{padding:0}},style:{width:"100%",height:"100%"}}),(0,r.jsx)("div",{style:{position:"absolute",textAlign:"center",pointerEvents:"none",top:"50%",left:"50%",transform:"translate(-50%, -50%)",lineHeight:1},children:(0,r.jsxs)("div",{style:{fontSize:"".concat(m,"px"),fontWeight:800,color:"#111",marginTop:30,display:"block"},children:[(0,r.jsx)("span",{style:{fontSize:"22px",fontWeight:"bold"},children:String(d)}),i&&(0,r.jsxs)("span",{style:{fontSize:"14px"},children:[" ",i]})]})})]})]})}function o(e){let{deviceMap:t,device:a,dataType:n,compact:s=!1}=e;if(!t||!a||0===a.length)return(0,r.jsx)("pre",{children:"No latest data yet"});let l=[];return(a.forEach(e=>{var a,r;let s=t[e];if(!s)return;let i=null==(r=s.Timestamp)||null==(a=r.split(".")[0])?void 0:a.replace("T"," "),o=Object.keys(s).filter(e=>!["Timestamp","DeviceID","DeviceType"].includes(e)&&"number"==typeof s[e]);(n&&n.length>0?o.filter(e=>n.includes(e)):o).forEach(t=>{let{max:a,unit:r,color:n}=function(e,t){let a={DSI:{max:31,unit:"Days",color:"#f2a007"},DSO:{max:31,unit:"Days",color:"#ff4d57"},DPO:{max:31,unit:"Days",color:"#11a36f"},CurrentRatio:{max:5,unit:"%",color:"#2b6ea6"},Humidity:{max:100,unit:"%",color:"#26b6b2"},Temperature:{max:50,unit:"\xb0C",color:"#ff9f40"},CO2:{max:2e3,unit:"ppm",color:"#9966ff"},PM2_5:{max:200,unit:"\xb5g/m\xb3",color:"#4bc0c0"},PM10:{max:200,unit:"\xb5g/m\xb3",color:"#36a2eb"},Battery:{max:100,unit:"%",color:"#2ecc71"}}[e];return a||(t<=1?{max:1,unit:"",color:"#26b6b2"}:t<=10?{max:10,unit:"",color:"#26b6b2"}:t<=100?{max:100,unit:"",color:"#26b6b2"}:t<=1e3?{max:1e3,unit:"",color:"#26b6b2"}:{max:Math.ceil(1.2*t),unit:"",color:"#26b6b2"})}(t,Number(s[t]));l.push({title:"".concat(e," • ").concat(t),value:Number(s[t]),max:a,unit:r,color:n,ts:i})})}),0===l.length)?(0,r.jsx)("pre",{children:"No numeric fields to display"}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{marginBottom:8,opacity:.7},children:["Latest timestamp: ",l[0].ts||"-"]}),(0,r.jsx)("div",{className:"dashboard-grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(".concat(s?160:220,"px, 1fr))"),gap:s?12:16},children:l.map((e,t)=>(0,r.jsx)(i,{...e,compact:s},t))})]})}l.t1.register(l.Bs,l.m_,l.s$)}},e=>{e.O(0,[647,689,243,414,441,255,358],()=>e(e.s=4749)),_N_E=e.O()}]);